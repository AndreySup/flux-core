Packages:
redis-2.4.10-1.el6.x86_64
hiredis-0.10.1-3.el6.x86_64
hiredis-devel-0.10.1-3.el6.x86_64

PMI header files:
cloned http://git.mpich.org/mpich.git
copied mpich/src/include/pmi*.h

There are interesting bits here:
mpich/src/pmi/pmi2 (especially README)
mpich/src/pm/hydra/pm/pmiserv/

Description

First dumb prototype to get our feet wet.
Start redis server on rank 0 node with spank plugin.
Create replacement libpmi.so.0 layered on top of hiredis API.
Start an MPICH job and watch the redis logs as the key-val store is used.

1) test in desktop with slurm and redis running:

$ redis_cli
redis 127.0.0.1:6379> flushall
OK
redis 127.0.0.1:6379> monitor
OK
1363992104.660279 "monitor"
...

# load mvapich2-gnu-shmem module, set LD_LIBRARY_PATH to current dir
$ srun -n2 ./mpi_hello
0: completed MPI_Init.  There are 2 tasks
0: completed first barrier
0: completed MPI_Finalize
$

# redis window says (for 2 procs):

1364235759.302983 [0 192.168.1.136:59773] "SUBSCRIBE" "job23:barrier"
1364235759.303153 [0 192.168.1.136:59772] "SET" "job23:hostname[0]" "jimbo.chaos"
1364235759.303190 [0 192.168.1.136:59775] "SUBSCRIBE" "job23:barrier"
1364235759.303260 [0 192.168.1.136:59772] "PUBLISH" "PMI" "0:PMI_KVS_Commit job23"
1364235759.303281 [0 192.168.1.136:59774] "SET" "job23:hostname[1]" "jimbo.chaos"
1364235759.303317 [0 192.168.1.136:59772] "EVAL" "if redis.call('incr', KEYS[1]) == tonumber(ARGV[1])  then redis.call('publish', KEYS[2], KEYS[1]) end" "2" "job23:barrier0" "job23:barrier" "2"
1364235759.303370 [0 lua] "incr" "job23:barrier0"
1364235759.303413 [0 192.168.1.136:59774] "PUBLISH" "PMI" "1:PMI_KVS_Commit job23"
1364235759.303454 [0 192.168.1.136:59774] "EVAL" "if redis.call('incr', KEYS[1]) == tonumber(ARGV[1])  then redis.call('publish', KEYS[2], KEYS[1]) end" "2" "job23:barrier0" "job23:barrier" "2"
1364235759.303479 [0 lua] "incr" "job23:barrier0"
1364235759.303486 [0 lua] "publish" "job23:barrier" "job23:barrier0"
1364235759.303547 [0 192.168.1.136:59774] "GET" "job23:hostname[0]"
1364235759.303575 [0 192.168.1.136:59772] "GET" "job23:hostname[1]"
1364235759.303597 [0 192.168.1.136:59774] "EVAL" "if redis.call('incr', KEYS[1]) == tonumber(ARGV[1])  then redis.call('publish', KEYS[2], KEYS[1]) end" "2" "job23:barrier1" "job23:barrier" "2"
1364235759.303622 [0 lua] "incr" "job23:barrier1"
1364235759.303691 [0 192.168.1.136:59772] "SET" "job23:sharedFilename[0]" "/dev/shm/mpich_shar_tmpkaQoOg"
1364235759.303753 [0 192.168.1.136:59772] "PUBLISH" "PMI" "0:PMI_KVS_Commit job23"
1364235759.303840 [0 192.168.1.136:59772] "EVAL" "if redis.call('incr', KEYS[1]) == tonumber(ARGV[1])  then redis.call('publish', KEYS[2], KEYS[1]) end" "2" "job23:barrier1" "job23:barrier" "2"
1364235759.303865 [0 lua] "incr" "job23:barrier1"
1364235759.303921 [0 lua] "publish" "job23:barrier" "job23:barrier1"
1364235759.304025 [0 192.168.1.136:59774] "GET" "job23:sharedFilename[0]"
1364235759.304775 [0 192.168.1.136:59774] "SET" "job23:P1-businesscard" "description#jimbo.chaos$port#39666$ifname#192.168.1.136$"
1364235759.304806 [0 192.168.1.136:59772] "SET" "job23:P0-businesscard" "description#jimbo.chaos$port#36643$ifname#192.168.1.136$"
1364235759.304829 [0 192.168.1.136:59774] "PUBLISH" "PMI" "1:PMI_KVS_Commit job23"
1364235759.304861 [0 192.168.1.136:59772] "PUBLISH" "PMI" "0:PMI_KVS_Commit job23"
1364235759.304878 [0 192.168.1.136:59774] "EVAL" "if redis.call('incr', KEYS[1]) == tonumber(ARGV[1])  then redis.call('publish', KEYS[2], KEYS[1]) end" "2" "job23:barrier2" "job23:barrier" "2"
1364235759.304910 [0 lua] "incr" "job23:barrier2"
1364235759.304943 [0 192.168.1.136:59772] "EVAL" "if redis.call('incr', KEYS[1]) == tonumber(ARGV[1])  then redis.call('publish', KEYS[2], KEYS[1]) end" "2" "job23:barrier2" "job23:barrier" "2"
1364235759.304971 [0 lua] "incr" "job23:barrier2"
1364235759.304980 [0 lua] "publish" "job23:barrier" "job23:barrier2"

# redis window says (for 4 procs):

1364235387.336319 [0 192.168.1.136:59728] "SUBSCRIBE" "job22:barrier"
1364235387.336437 [0 192.168.1.136:59730] "SUBSCRIBE" "job22:barrier"
1364235387.336468 [0 192.168.1.136:59727] "SET" "job22:hostname[0]" "jimbo.chaos"
1364235387.336522 [0 192.168.1.136:59729] "SET" "job22:hostname[1]" "jimbo.chaos"
1364235387.336550 [0 192.168.1.136:59727] "PUBLISH" "PMI" "0:PMI_KVS_Commit job22"
1364235387.336583 [0 192.168.1.136:59729] "PUBLISH" "PMI" "1:PMI_KVS_Commit job22"
1364235387.336603 [0 192.168.1.136:59727] "EVAL" "if redis.call('incr', KEYS[1]) == tonumber(ARGV[1])  then redis.call('publish', KEYS[2], KEYS[1]) end" "2" "job22:barrier0" "job22:barrier" "4"
1364235387.336640 [0 lua] "incr" "job22:barrier0"
1364235387.336686 [0 192.168.1.136:59729] "EVAL" "if redis.call('incr', KEYS[1]) == tonumber(ARGV[1])  then redis.call('publish', KEYS[2], KEYS[1]) end" "2" "job22:barrier0" "job22:barrier" "4"
1364235387.336711 [0 lua] "incr" "job22:barrier0"
1364235387.336764 [0 192.168.1.136:59732] "SUBSCRIBE" "job22:barrier"
1364235387.336864 [0 192.168.1.136:59731] "SET" "job22:hostname[2]" "jimbo.chaos"
1364235387.336932 [0 192.168.1.136:59731] "PUBLISH" "PMI" "2:PMI_KVS_Commit job22"
1364235387.336995 [0 192.168.1.136:59731] "EVAL" "if redis.call('incr', KEYS[1]) == tonumber(ARGV[1])  then redis.call('publish', KEYS[2], KEYS[1]) end" "2" "job22:barrier0" "job22:barrier" "4"
1364235387.337020 [0 lua] "incr" "job22:barrier0"
1364235387.337149 [0 192.168.1.136:59734] "SUBSCRIBE" "job22:barrier"
1364235387.337215 [0 192.168.1.136:59733] "SET" "job22:hostname[3]" "jimbo.chaos"
1364235387.337255 [0 192.168.1.136:59733] "PUBLISH" "PMI" "3:PMI_KVS_Commit job22"
1364235387.337287 [0 192.168.1.136:59733] "EVAL" "if redis.call('incr', KEYS[1]) == tonumber(ARGV[1])  then redis.call('publish', KEYS[2], KEYS[1]) end" "2" "job22:barrier0" "job22:barrier" "4"
1364235387.337312 [0 lua] "incr" "job22:barrier0"
1364235387.337319 [0 lua] "publish" "job22:barrier" "job22:barrier0"
1364235387.337388 [0 192.168.1.136:59733] "GET" "job22:hostname[0]"
1364235387.337411 [0 192.168.1.136:59731] "GET" "job22:hostname[0]"
1364235387.337420 [0 192.168.1.136:59733] "GET" "job22:hostname[1]"
1364235387.337446 [0 192.168.1.136:59729] "GET" "job22:hostname[0]"
1364235387.337455 [0 192.168.1.136:59727] "GET" "job22:hostname[1]"
1364235387.337462 [0 192.168.1.136:59733] "GET" "job22:hostname[2]"
1364235387.337492 [0 192.168.1.136:59731] "GET" "job22:hostname[1]"
1364235387.337519 [0 192.168.1.136:59729] "GET" "job22:hostname[2]"
1364235387.337534 [0 192.168.1.136:59727] "GET" "job22:hostname[2]"
1364235387.337542 [0 192.168.1.136:59733] "EVAL" "if redis.call('incr', KEYS[1]) == tonumber(ARGV[1])  then redis.call('publish', KEYS[2], KEYS[1]) end" "2" "job22:barrier1" "job22:barrier" "4"
1364235387.337565 [0 lua] "incr" "job22:barrier1"
1364235387.337591 [0 192.168.1.136:59729] "GET" "job22:hostname[3]"
1364235387.337611 [0 192.168.1.136:59731] "GET" "job22:hostname[3]"
1364235387.337668 [0 192.168.1.136:59727] "GET" "job22:hostname[3]"
1364235387.337693 [0 192.168.1.136:59731] "EVAL" "if redis.call('incr', KEYS[1]) == tonumber(ARGV[1])  then redis.call('publish', KEYS[2], KEYS[1]) end" "2" "job22:barrier1" "job22:barrier" "4"
1364235387.337717 [0 lua] "incr" "job22:barrier1"
1364235387.337748 [0 192.168.1.136:59729] "EVAL" "if redis.call('incr', KEYS[1]) == tonumber(ARGV[1])  then redis.call('publish', KEYS[2], KEYS[1]) end" "2" "job22:barrier1" "job22:barrier" "4"
1364235387.337771 [0 lua] "incr" "job22:barrier1"
1364235387.337791 [0 192.168.1.136:59727] "SET" "job22:sharedFilename[0]" "/dev/shm/mpich_shar_tmpNuKheh"
1364235387.337843 [0 192.168.1.136:59727] "PUBLISH" "PMI" "0:PMI_KVS_Commit job22"
1364235387.337911 [0 192.168.1.136:59727] "EVAL" "if redis.call('incr', KEYS[1]) == tonumber(ARGV[1])  then redis.call('publish', KEYS[2], KEYS[1]) end" "2" "job22:barrier1" "job22:barrier" "4"
1364235387.337936 [0 lua] "incr" "job22:barrier1"
1364235387.337946 [0 lua] "publish" "job22:barrier" "job22:barrier1"
1364235387.338061 [0 192.168.1.136:59733] "GET" "job22:sharedFilename[0]"
1364235387.338086 [0 192.168.1.136:59729] "GET" "job22:sharedFilename[0]"
1364235387.338109 [0 192.168.1.136:59731] "GET" "job22:sharedFilename[0]"
1364235387.339157 [0 192.168.1.136:59733] "SET" "job22:P3-businesscard" "description#jimbo.chaos$port#50725$ifname#192.168.1.136$"
1364235387.339187 [0 192.168.1.136:59727] "SET" "job22:P0-businesscard" "description#jimbo.chaos$port#43615$ifname#192.168.1.136$"
1364235387.339212 [0 192.168.1.136:59733] "PUBLISH" "PMI" "3:PMI_KVS_Commit job22"
1364235387.339229 [0 192.168.1.136:59729] "SET" "job22:P1-businesscard" "description#jimbo.chaos$port#50297$ifname#192.168.1.136$"
1364235387.339262 [0 192.168.1.136:59731] "SET" "job22:P2-businesscard" "description#jimbo.chaos$port#42047$ifname#192.168.1.136$"
1364235387.339279 [0 192.168.1.136:59733] "EVAL" "if redis.call('incr', KEYS[1]) == tonumber(ARGV[1])  then redis.call('publish', KEYS[2], KEYS[1]) end" "2" "job22:barrier2" "job22:barrier" "4"
1364235387.339304 [0 lua] "incr" "job22:barrier2"
1364235387.339342 [0 192.168.1.136:59727] "PUBLISH" "PMI" "0:PMI_KVS_Commit job22"
1364235387.339353 [0 192.168.1.136:59729] "PUBLISH" "PMI" "1:PMI_KVS_Commit job22"
1364235387.339397 [0 192.168.1.136:59731] "PUBLISH" "PMI" "2:PMI_KVS_Commit job22"
1364235387.339436 [0 192.168.1.136:59727] "EVAL" "if redis.call('incr', KEYS[1]) == tonumber(ARGV[1])  then redis.call('publish', KEYS[2], KEYS[1]) end" "2" "job22:barrier2" "job22:barrier" "4"
1364235387.339462 [0 lua] "incr" "job22:barrier2"
1364235387.339473 [0 192.168.1.136:59729] "EVAL" "if redis.call('incr', KEYS[1]) == tonumber(ARGV[1])  then redis.call('publish', KEYS[2], KEYS[1]) end" "2" "job22:barrier2" "job22:barrier" "4"
1364235387.339498 [0 lua] "incr" "job22:barrier2"
1364235387.339520 [0 192.168.1.136:59731] "EVAL" "if redis.call('incr', KEYS[1]) == tonumber(ARGV[1])  then redis.call('publish', KEYS[2], KEYS[1]) end" "2" "job22:barrier2" "job22:barrier" "4"
1364235387.339548 [0 lua] "incr" "job22:barrier2"
1364235387.339554 [0 lua] "publish" "job22:barrier" "job22:barrier2"

