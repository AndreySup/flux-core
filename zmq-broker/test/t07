#!/bin/bash -e

TEST=`basename $0`
DIR=$TEST.a.b
EXPRESULT="$DIR.a{value}
$DIR.b{value}
$DIR.c{value}
$DIR.d{value}
$DIR.e{value}"

test_cleanup() {
    ./tkvs unlink $TEST
    ./tkvs commit
}

test_cleanup

./tkvs put_int $DIR.a 69
./tkvs put_int64 $DIR.b 70
./tkvs put_double $DIR.c 3.14
./tkvs put_string $DIR.d "snerg"
./tkvs put_boolean $DIR.e "true"
./tkvs commit

# Retrieve directory containing new key
RESULT=`./tkvs get_dir $DIR`
test "$RESULT" == "$EXPRESULT"

test_cleanup

exit 0
